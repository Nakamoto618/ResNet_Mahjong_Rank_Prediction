# ResNet_Mahjong_Rank_Prediction

麻雀データを用いたResNetによる画像分類モデル
このリポジトリは、麻雀の対局データを画像データとして変換し、ResNetを用いてプレイヤーの着順を予測するプロジェクトです。ディープラーニングを用いて麻雀の対局情報を視覚的に捉え、ゲーム状態のパターンを学習することを目指しています。

目次
概要
データについて
データ準備
モデルアーキテクチャ
学習と評価
インストール方法
使用方法
結果
今後の課題
参考文献
コントリビューション
ライセンス
概要
麻雀はその複雑なルールと確率的な要素により、対局結果の予測が難しいゲームです。本プロジェクトでは、対局データを画像データに変換し、CNN（畳み込みニューラルネットワーク）の一種であるResNetを用いてプレイヤーの着順予測を行います。

このモデルでは、各局面を画像形式で表現し、画像処理技術を応用することで、対局情報を効果的に学習させることを目的としています。

データについて
使用したデータはオンライン麻雀サービス「天鳳」よりお借りしました。本プロジェクトは研究目的でデータを利用していますが、天鳳のデータの取り扱いについてはライセンスに従い、加工データの公開可否についても慎重に検討してください。

注意: 加工したデータをGitHub等のパブリックな場所に公開する場合、天鳳のライセンス規約に抵触しないかを事前に確認することをお勧めします。ライセンスに関する詳細な情報については、天鳳の公式サイトやライセンスガイドラインをご確認ください。

データ準備
麻雀の対局データは、各種状態やプレイヤーの行動を多チャンネルの画像形式に変換し、以下のような形で表現されています：

データ形状： (4, 9, 300)
チャンネル数 (300)：牌情報、プレイヤーの行動、局面の状態などの各種情報を符号化。
高さ (4) と幅 (9)：局面を視覚的に配置し、ResNetでの特徴抽出を容易にしています。
これらの画像データを使用し、ResNetモデルに入力することで、局面ごとのパターンを学習し、プレイヤーの最終的な着順を予測します。

データ構造
以下のようなディレクトリ構成でデータを格納しています：

markdown
コードをコピーする
- data/
    - train/
        - game_state_1.npy
        - game_state_2.npy
        - ...
    - test/
        - game_state_101.npy
        - game_state_102.npy
        - ...
各 .npy ファイルは、麻雀の1局面を表す画像データ（NumPy配列）となっています。

モデルアーキテクチャ
本プロジェクトでは、麻雀の局面の空間的な配置を保つため、プーリング層を使用せず、位置情報を重視したResNetを使用しています。主なモデル構成は以下の通りです：

Residual Block（残差ブロック）：複雑なパターンや相関関係を捉えるために使用。
全結合層（Fully Connected Layer）：残差ブロックで抽出された特徴量を結合し、分類を行う。
Softmax 出力層：プレイヤーの着順分布を予測する確率分布を出力。
学習と評価
損失関数：クロスエントロピー損失関数を使用し、プレイヤーの着順を分類問題として取り扱います。
最適化アルゴリズム：Adam Optimizerを採用し、学習率調整などを行っています。
評価指標：各着順に対するROC AUCスコアを算出し、モデルの性能を評価しています。
インストール方法
本プロジェクトを実行するには、以下のパッケージをインストールする必要があります：

bash
コードをコピーする
pip install -r requirements.txt
使用方法
データの準備（麻雀の局面データを.npyファイルとして保存）
モデルのトレーニング
bash
コードをコピーする
python train.py --data_dir=data/train --epochs=50
テストデータでの評価
bash
コードをコピーする
python evaluate.py --data_dir=data/test --model_path=models/resnet_model.pth
結果
現時点でのモデルのROC AUCスコアは以下の通りです：

マクロ平均：0.82
マイクロ平均：0.83
各クラスのスコア：[0.92, 0.72, 0.76, 0.88]
これらのスコアは、麻雀の着順予測としては非常に高いパフォーマンスを示しています。

今後の課題
Transformerの組み込みによるモデルの改良
より高度な特徴量の抽出と選定
リアルタイム対局中の着順予測システムの開発
参考文献
天鳳公式サイト: https://tenhou.net/
ResNetに関する論文: Deep Residual Learning for Image Recognition (He et al.)
Mahjong AIに関する参考文献: NAGA27 (Tanaka et al.)
コントリビューション
バグ報告や機能追加のリクエストは、Issue ページからお願いします。また、プルリクエストも歓迎しています。

ライセンス
本プロジェクトは MITライセンス の下で提供されています。

注意: 天鳳データの加工および公開については、天鳳のライセンス規約に従ってください。研究目的の利用は許可されていますが、加工後のデータを公開する際には十分に注意を払ってください。
